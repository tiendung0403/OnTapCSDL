# README - HÆ°á»›ng dáº«n vá» DBMS vÃ  SQL Server
# Má»¥c lá»¥c

1. [ThÃ¡p DIKW](#thÃ¡p-dikw)
2. [CÃ¡c loáº¡i table Ä‘áº·c biá»‡t](#cÃ¡c-loáº¡i-table-Ä‘áº·c-biá»‡t)
   - [Temporary Table (Báº£ng táº¡m)](#temporary-table-báº£ng-táº¡m)
   - [CTE (Common Table Expression)](#cte-common-table-expression)
   - [Memory-Optimized Tables](#memory-optimized-tables)
   - [Partitioned Tables](#partitioned-tables)
   - [Temporal Tables](#temporal-tables)
3. [View](#view)
4. [Index](#index)
5. [Cursor](#cursor)
6. [CÃ¡c Ä‘áº·c Ä‘iá»ƒm cá»§a mÃ´ hÃ¬nh DBMS](#cÃ¡c-Ä‘áº·c-Ä‘iá»ƒm-cá»§a-mÃ´-hÃ¬nh-dbms)
7. [NgÃ´n ngá»¯ trong DBMS](#ngÃ´n-ngá»¯-trong-dbms)
   - [NgÃ´n ngá»¯ Ä‘á»‹nh nghÄ©a dá»¯ liá»‡u (DDL)](#ngÃ´n-ngá»¯-Ä‘á»‹nh-nghÄ©a-dá»¯-liá»‡u-ddl)
   - [NgÃ´n ngá»¯ thao tÃ¡c dá»¯ liá»‡u (DML)](#ngÃ´n-ngá»¯-thao-tÃ¡c-dá»¯-liá»‡u-dml)
8. [PhÃ¢n loáº¡i End-Users](#phÃ¢n-loáº¡i-end-users)
9. [TrÃ¡ch nhiá»‡m cá»§a DBA](#trÃ¡ch-nhiá»‡m-cá»§a-dba)
10. [Tá»• chá»©c CSDL](#tá»•-chá»©c-csdl)
11. [RAID vÃ  LÆ°u trá»¯](#raid-vÃ -lÆ°u-trá»¯)
12. [Database trong SQL Server](#database-trong-sql-server)
13. [Quáº£n trá»‹ Ä‘á»‘i tÆ°á»£ng CSDL](#quáº£n-trá»‹-Ä‘á»‘i-tÆ°á»£ng-csdl)
14. [RÃ ng buá»™c trong SQL](#rÃ ng-buá»™c-trong-sql)
15. [HÃ m trong SQL](#hÃ m-trong-sql)

# ChÆ°Æ¡ng 1

## ThÃ¡p DIKW


ThÃ¡p DIKW lÃ  má»™t mÃ´ hÃ¬nh mÃ´ táº£ quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u tá»« thÃ´ sang hiá»ƒu biáº¿t sÃ¢u sáº¯c, bao gá»“m 4 cáº¥p Ä‘á»™:

### Level 1: Data (Dá»¯ liá»‡u thÃ´)
- Dá»¯ liá»‡u Ä‘Æ°á»£c thu tháº­p tá»« nhiá»u nguá»“n khÃ¡c nhau.
- Tá»“n táº¡i Ä‘á»™c láº­p, chÆ°a qua xá»­ lÃ½, vÃ­ dá»¥: "HÃ  Ná»™i", "25", hÃ¬nh áº£nh.

### Level 2: Information (ThÃ´ng tin = Data + Context)
- Dá»¯ liá»‡u Ä‘Æ°á»£c sáº¯p xáº¿p vÃ  tá»• chá»©c cÃ³ Ã½ nghÄ©a.
- CÃ³ thá»ƒ tráº£ lá»i cÃ¡c cÃ¢u há»i nhÆ° "á»Ÿ Ä‘Ã¢u", "cÃ¡i gÃ¬", "cÃ¡i nÃ o".
- VÃ­ dá»¥: "HCM hÃ´m nay 25 Ä‘á»™, khÃ´ng mÆ°a".

### Level 3: Knowledge (Kiáº¿n thá»©c = Information + Meaning)
- ThÃ´ng tin Ä‘Æ°á»£c gáº¯n vá»›i Ä‘á»‹nh nghÄ©a vÃ  Ã½ nghÄ©a.
- LÃ  káº¿t quáº£ cá»§a quÃ¡ trÃ¬nh há»c táº­p vÃ  cháº¯t lá»c thÃ´ng tin.

### Level 4: Wisdom (TrÃ­ tuá»‡)
- TÆ° duy, thÃ´ng thÃ¡i, táº­p há»£p kiáº¿n thá»©c chuyÃªn sÃ¢u vá» má»™t lÄ©nh vá»±c cá»¥ thá»ƒ.

---


## CÃ¡c Ä‘áº·c Ä‘iá»ƒm cá»§a DBMS

### 1. Tá»± mÃ´ táº£ (Self-Describing Nature)
- DBMS cÃ³ catalog ná»™i bá»™ Ä‘á»ƒ lÆ°u trá»¯ metadata (dá»¯ liá»‡u vá» dá»¯ liá»‡u).
- Metadata bao gá»“m: cáº¥u trÃºc báº£ng, kiá»ƒu dá»¯ liá»‡u, rÃ ng buá»™c, quyá»n truy cáº­p...
- GiÃºp há»‡ thá»‘ng lÃ m viá»‡c vá»›i nhiá»u cÆ¡ sá»Ÿ dá»¯ liá»‡u mÃ  khÃ´ng cáº§n thiáº¿t láº­p thá»§ cÃ´ng.

### 2. CÃ¡ch ly chÆ°Æ¡ng trÃ¬nh vÃ  dá»¯ liá»‡u (Program-Data Independence)
- Cho phÃ©p thay Ä‘á»•i cáº¥u trÃºc dá»¯ liá»‡u (thÃªm cá»™t, Ä‘á»•i kiá»ƒu dá»¯ liá»‡u) mÃ  khÃ´ng cáº§n sá»­a Ä‘á»•i toÃ n bá»™ chÆ°Æ¡ng trÃ¬nh truy cáº­p CSDL.
- GiÃºp há»‡ thá»‘ng dá»… má»Ÿ rá»™ng, báº£o trÃ¬ vÃ  linh hoáº¡t hÆ¡n.

### 3. Trá»«u tÆ°á»£ng hÃ³a dá»¯ liá»‡u (Data Abstraction)
- DBMS áº©n chi tiáº¿t lÆ°u trá»¯ dá»¯ liá»‡u trÃªn á»• Ä‘Ä©a, ngÆ°á»i dÃ¹ng chá»‰ lÃ m viá»‡c vá»›i mÃ´ hÃ¬nh dá»¯ liá»‡u á»Ÿ má»©c logic.
- Ba má»©c trá»«u tÆ°á»£ng hÃ³a dá»¯ liá»‡u:
  1. **Má»©c váº­t lÃ½ (Physical Level)**: CÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trÃªn Ä‘Ä©a.
  2. **Má»©c logic (Logical Level)**: Cáº¥u trÃºc dá»¯ liá»‡u vÃ  má»‘i quan há»‡ giá»¯a chÃºng.
  3. **Má»©c xem (View Level)**: Dá»¯ liá»‡u hiá»ƒn thá»‹ cho tá»«ng nhÃ³m ngÆ°á»i dÃ¹ng.

### 4. Há»— trá»£ nhiá»u gÃ³c nhÃ¬n (Multiple Views)
- Má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u cung cáº¥p nhiá»u gÃ³c nhÃ¬n khÃ¡c nhau cho tá»«ng loáº¡i ngÆ°á»i dÃ¹ng.
- VÃ­ dá»¥:
  - NgÆ°á»i quáº£n lÃ½ tháº¥y toÃ n bá»™ dá»¯ liá»‡u nhÃ¢n sá»±.
  - NhÃ¢n viÃªn chá»‰ tháº¥y thÃ´ng tin cÃ¡ nhÃ¢n cá»§a há».
- GiÃºp tÄƒng báº£o máº­t vÃ  tá»‘i Æ°u hÃ³a truy váº¥n.

### 5. Chia sáº» dá»¯ liá»‡u vÃ  xá»­ lÃ½ Ä‘á»“ng thá»i (Data Sharing & Concurrency Control)
- Há»— trá»£ nhiá»u ngÆ°á»i dÃ¹ng truy cáº­p CSDL cÃ¹ng lÃºc mÃ  khÃ´ng gÃ¢y lá»—i hoáº·c xung Ä‘á»™t.
- CÆ¡ cháº¿ kiá»ƒm soÃ¡t Ä‘á»“ng thá»i (Concurrency Control) Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n vÃ  trÃ¡nh deadlock.
- VÃ­ dá»¥: Há»‡ thá»‘ng ngÃ¢n hÃ ng cho phÃ©p nhiá»u giao dá»‹ch cáº­p nháº­t tÃ i khoáº£n cÃ¹ng lÃºc mÃ  khÃ´ng sai sÃ³t.

### 6. RÃ ng buá»™c toÃ n váº¹n (Data Integrity)
- Äáº£m báº£o tÃ­nh chÃ­nh xÃ¡c vÃ  Ä‘á»“ng nháº¥t cá»§a dá»¯ liá»‡u.
- Sá»­ dá»¥ng cÃ¡c rÃ ng buá»™c nhÆ°:
  - Primary Key (khÃ³a chÃ­nh)
  - Foreign Key (khÃ³a ngoáº¡i)
  - Unique, Not Null, Check, Default
- VÃ­ dá»¥: KhÃ´ng thá»ƒ nháº­p Ä‘Æ¡n hÃ ng vá»›i mÃ£ khÃ¡ch hÃ ng khÃ´ng tá»“n táº¡i.

### 7. CÆ¡ cháº¿ báº£o máº­t máº¡nh máº½ (Security & Authorization) ðŸ”
- Kiá»ƒm soÃ¡t quyá»n truy cáº­p dá»±a trÃªn vai trÃ² ngÆ°á»i dÃ¹ng.
- Há»— trá»£ mÃ£ hÃ³a dá»¯ liá»‡u Ä‘á»ƒ chá»‘ng truy cáº­p trÃ¡i phÃ©p.
- VÃ­ dá»¥:
  - Admin: thÃªm/sá»­a/xÃ³a dá»¯ liá»‡u.
  - KhÃ¡ch hÃ ng: chá»‰ xem thÃ´ng tin Ä‘Æ¡n hÃ ng.

### 8. Há»— trá»£ sao lÆ°u vÃ  phá»¥c há»“i dá»¯ liá»‡u (Backup & Recovery) ðŸ’¾
- Báº£o vá»‡ CSDL khá»i lá»—i do máº¥t Ä‘iá»‡n, há»ng á»• cá»©ng, táº¥n cÃ´ng máº¡ng...
- Cung cáº¥p cÆ¡ cháº¿ sao lÆ°u tá»± Ä‘á»™ng vÃ  khÃ´i phá»¥c dá»¯ liá»‡u Ä‘á»ƒ trÃ¡nh máº¥t mÃ¡t.

### 9. Hiá»‡u suáº¥t cao vÃ  tá»‘i Æ°u hÃ³a truy váº¥n (Query Optimization) ðŸš€
- Sá»­ dá»¥ng thuáº­t toÃ¡n tá»‘i Æ°u hÃ³a Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ xá»­ lÃ½ truy váº¥n SQL.
- Chá»‰ má»¥c (Indexing), phÃ¢n máº£nh (Partitioning), bá»™ nhá»› Ä‘á»‡m (Caching) giÃºp truy xuáº¥t dá»¯ liá»‡u nhanh hÆ¡n.
- VÃ­ dá»¥: Google Search tÃ¬m kiáº¿m hÃ ng tá»· dá»¯ liá»‡u trong vÃ i mili giÃ¢y.

### 10. Há»— trá»£ nhiá»u mÃ´ hÃ¬nh dá»¯ liá»‡u (Multiple Data Models)
- DBMS há»— trá»£ cÃ¡c mÃ´ hÃ¬nh dá»¯ liá»‡u nhÆ°:
  - MÃ´ hÃ¬nh quan há»‡ (Relational Model - SQL): MySQL, SQL Server
  - MÃ´ hÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng (Object-Oriented Model): MongoDB
  - MÃ´ hÃ¬nh Ä‘á»“ thá»‹ (Graph Database): Neo4j
  - MÃ´ hÃ¬nh khÃ³a-giÃ¡ trá»‹ (Key-Value Model): Redis

## ThÃ nh pháº§n cá»§a DBMS
- **Data**: Dá»¯ liá»‡u.
- **Metadata**: SiÃªu dá»¯ liá»‡u mÃ´ táº£ cáº¥u trÃºc lÆ°á»£c Ä‘á»“ cá»§a CSDL.
- **Statistics**: Dá»¯ liá»‡u thá»‘ng kÃª vá» Ä‘áº·c tÃ­nh cá»§a dá»¯ liá»‡u (kÃ­ch thÆ°á»›c, giÃ¡ trá»‹...).
- **Index**: Chá»‰ má»¥c, cáº¥u trÃºc dá»¯ liá»‡u há»— trá»£ truy xuáº¥t dá»¯ liá»‡u hiá»‡u quáº£.

## NgÃ´n ngá»¯ CSDL
- **DDL**: NgÃ´n ngá»¯ Ä‘á»‹nh nghÄ©a cáº¥u trÃºc dá»¯ liá»‡u (táº¡o báº£ng, cá»™t...).
- **DML**: NgÃ´n ngá»¯ thao tÃ¡c dá»¯ liá»‡u (SELECT, INSERT INTO...).
- **DCL**: NgÃ´n ngá»¯ kiá»ƒm soÃ¡t dá»¯ liá»‡u (phÃ¢n quyá»n user).
- **TCL**: NgÃ´n ngá»¯ kiá»ƒm soÃ¡t giao dá»‹ch.

## NgÆ°á»i dÃ¹ng CSDL
- **Database User**: NgÆ°á»i thao tÃ¡c, truy cáº­p vÃ  sá»­ dá»¥ng dá»¯ liá»‡u theo má»©c quyá»n Ä‘Æ°á»£c cáº¥p.
- **DBA (Database Administrators)**:
  - Chá»‹u trÃ¡ch nhiá»‡m cáº¥p quyá»n truy cáº­p, giÃ¡m sÃ¡t tÃ i nguyÃªn há»‡ thá»‘ng.
  - Sáºµn sÃ ng phá»¥c há»“i dá»¯ liá»‡u khi xáº£y ra sá»± cá»‘, cháº©n Ä‘oÃ¡n vÃ  báº£o trÃ¬ há»‡ thá»‘ng.
- **Database Designer**: Thiáº¿t káº¿ cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  cÃ¡c rÃ ng buá»™c dá»¯ liá»‡u.
- **End User**: NgÆ°á»i dÃ¹ng cuá»‘i, sá»­ dá»¥ng dá»¯ liá»‡u qua á»©ng dá»¥ng/UI dá»±a trÃªn CSDL.

---

# ChÆ°Æ¡ng 2: Cáº¥u trÃºc lÆ°u trá»¯

## Cáº¥u trÃºc cá»§a á»• Ä‘Ä©a
- **Track**: CÃ¡c vÃ²ng trÃ²n Ä‘á»“ng tÃ¢m trÃªn máº·t Ä‘Ä©a.
- **Sector**: CÃ¡c pháº§n nhá» Ä‘Æ°á»£c chia tá»« track.
- **Cylinder**: Táº­p há»£p cÃ¡c vÃ²ng trÃ²n Ä‘á»“ng tÃ¢m náº±m cÃ¹ng vá»‹ trÃ­ tháº³ng Ä‘á»©ng trÃªn cÃ¡c Ä‘Ä©a khÃ¡c nhau.

## CÃ¡c yáº¿u tá»‘ áº£nh hÆ°á»Ÿng Ä‘áº¿n truy xuáº¥t dá»¯ liá»‡u
- **Váº­t liá»‡u lÆ°u trá»¯**: áº¢nh hÆ°á»Ÿng 70-80% tá»‘c Ä‘á»™ truy xuáº¥t (SSD nhanh hÆ¡n HDD).
- **Tá»‘c Ä‘á»™ quay cá»§a Ä‘Ä©a**: Tá»‘c Ä‘á»™ cao thÃ¬ truy xuáº¥t nhanh hÆ¡n, vÃ  ngÆ°á»£c láº¡i.
- **Seek Time**: Thá»i gian Ä‘áº§u Ä‘á»c di chuyá»ƒn Ä‘áº¿n track.
- **Rotational Latency**: Thá»i gian chá» Ä‘Ä©a quay Ä‘áº¿n sector.
- **Cáº¥u trÃºc dá»¯ liá»‡u lÆ°u trá»¯**: Dá»¯ liá»‡u liÃªn tá»¥c truy xuáº¥t nhanh hÆ¡n dá»¯ liá»‡u phÃ¢n máº£nh.

## Máº«u tin
- **Unspanned**: Dá»¯ liá»‡u lÆ°u trá»¯ trong má»™t block, khÃ´ng bá»‹ chia cáº¯t.
- **Spanned**: Máº«u tin vÆ°á»£t kÃ­ch thÆ°á»›c block, Ä‘Æ°á»£c chia Ä‘á»ƒ lÆ°u trá»¯ trong nhiá»u block.

## RAID
- Táº­p há»£p cÃ¡c Ä‘Ä©a thÃ nh má»™t Ä‘Ä©a duy nháº¥t, tÄƒng hiá»‡u suáº¥t vÃ  sá»­a lá»—i.
- **RAID 0**: 
  - Gá»™p tá»« 2-n Ä‘Ä©a, dá»¯ liá»‡u tráº£i Ä‘á»u, tÄƒng hiá»‡u suáº¥t Ä‘á»c/ghi, khÃ´ng dá»± phÃ²ng, há»ng má»™t Ä‘Ä©a máº¥t toÃ n bá»™ dá»¯ liá»‡u.
- **RAID 1**: 
  - ÄÄ©a giá»‘ng nhau, dá»¯ liá»‡u sao chÃ©p, tá»‘c Ä‘á»™ ghi cháº­m, chá»‹u lá»—i cao, má»™t Ä‘Ä©a há»ng váº«n hoáº¡t Ä‘á»™ng.
- **RAID 5**: 
  - Tá»« 3-n Ä‘Ä©a, dá»± phÃ²ng trÃªn má»™t Ä‘Ä©a, phÃ¢n tÃ¡n dá»¯ liá»‡u, tá»‘c Ä‘á»™ Ä‘á»c tÄƒng, ghi giáº£m, há»ng má»™t Ä‘Ä©a váº«n phá»¥c há»“i Ä‘Æ°á»£c.
- **RAID 10**: 
  - Tá»« 4-n Ä‘Ä©a (sá»‘ cháºµn), phÃ¢n ná»­a ghi, phÃ¢n ná»­a sao chÃ©p, káº¿t há»£p hiá»‡u suáº¥t vÃ  chá»‹u lá»—i.

## Máº¡ng lÆ°u trá»¯ SAN
- Máº¡ng lÆ°u trá»¯ riÃªng biá»‡t káº¿t ná»‘i cÃ¡c thiáº¿t bá»‹ lÆ°u trá»¯ (á»• cá»©ng).
- Gá»™p há»‡ thá»‘ng dÃ¹ng chung qua máº¡ng riÃªng, dá»… quáº£n lÃ½ vÃ  má»Ÿ rá»™ng.

---

# ChÆ°Æ¡ng 3: Quáº£n trá»‹ Ä‘á»‘i tÆ°á»£ng CSDL trong SQL Server

## System Database

- **Master**  
  - NÆ¡i lÆ°u trá»¯ cÃ¡c cáº¥u hÃ¬nh há»‡ thá»‘ng, thÃ´ng tin khá»Ÿi Ä‘á»™ng, thÃ´ng tin mÃ´ táº£ cÃ¡c database, danh sÃ¡ch login.

- **Tempdb**  
  - NÆ¡i lÆ°u trá»¯ cÃ¡c báº£ng táº¡m vÃ  dá»¯ liá»‡u táº¡m thá»i.  
  - ÄÆ°á»£c reset sáº¡ch sáº½ má»—i láº§n database khá»Ÿi Ä‘á»™ng láº¡i.

- **Model**  
  - KhuÃ´n máº«u Ä‘á»ƒ táº¡o ra database trong há»‡ thá»‘ng.  
  - Khi sá»­a Ä‘á»•i trong nÃ y, cÃ¡c database táº¡o sau sáº½ mang Ä‘áº·c Ä‘iá»ƒm má»›i (khuÃ´n Ä‘Ãºc).

- **Msdb**  
  - CÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥u hÃ¬nh cho cÃ¡c tÃ¡c vá»¥ tá»± Ä‘á»™ng nhÆ° thÃ´ng bÃ¡o sau 23h, cÃ¡c job schedule.

## Tá»• chá»©c táº­p tin CSDL

- Má»—i database pháº£i cÃ³ Ã­t nháº¥t 1 data file vÃ  1 log file.  
- **Data File**: LÆ°u trá»¯ dá»¯ liá»‡u vÃ  cÃ¡c objects.  
- **Log File**: Ghi láº¡i táº¥t cáº£ thay Ä‘á»•i cá»§a database, há»— trá»£ hiá»‡u quáº£ trong quÃ¡ trÃ¬nh phá»¥c há»“i dá»¯ liá»‡u khi cÃ³ sá»± cá»‘.  
- **Primary Data File**:  
  - LÆ°u trá»¯ dá»¯ liá»‡u gá»‘c (báº£ng, thÃ´ng tin khá»Ÿi Ä‘á»™ng).  
  - Má»—i database cÃ³ má»™t file nÃ y, Ä‘uÃ´i má»Ÿ rá»™ng `.mdf`.  
- **Secondary Data File**:  
  - Pháº§n má»Ÿ rá»™ng `.ndf`, cÃ³ thá»ƒ cÃ³ hoáº·c khÃ´ng.  
  - DÃ¹ng Ä‘á»ƒ má»Ÿ rá»™ng dá»¯ liá»‡u bá»• sung cho primary file, tráº£i dá»¯ liá»‡u giÃºp truy váº¥n nhanh hÆ¡n.  
- **Transaction Log File**:  
  - Ghi láº¡i nháº­t kÃ½ giao dá»‹ch trong database, phá»¥c há»“i dá»¯ liá»‡u khi cÃ³ sá»± cá»‘.  
  - Pháº£i cÃ³ Ã­t nháº¥t má»™t log file, Ä‘uÃ´i má»Ÿ rá»™ng `.ldf`.  
- **Filegroups**:  
  - Chá»©a cÃ¡c file `.mdf`, `.ndf`, dÃ¹ng Ä‘á»ƒ quáº£n lÃ½ cÃ¡c file váº­t lÃ½.  
  - Chia nhá» dá»¯ liá»‡u Ä‘á»ƒ dÃ n tráº£i trÃªn cÃ¡c RAID khi database quÃ¡ lá»›n, tÄƒng tá»‘c Ä‘á»™ truy váº¥n.  
  - **Primary Filegroup**:  
    - Chá»©a primary data files, system tables vÃ  cÃ¡c file khÃ´ng Ä‘áº·t vÃ o filegroup khÃ¡c.  
    - **System Tables**: CÃ¡c table do SQL Server tá»± Ä‘á»™ng táº¡o khi táº¡o database.

- **Cháº¿ Ä‘á»™ Automatic Filegrowth**:  
  - Cháº¿ Ä‘á»™ tá»± Ä‘á»™ng tÄƒng kÃ­ch thÆ°á»›c file lÆ°u trá»¯.  
  - Má»—i láº§n táº¡o file cÃ³ kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh, khi Ä‘áº¡t giá»›i háº¡n sáº½ tá»± Ä‘á»™ng tÄƒng Ä‘áº¿n khi Ä‘áº§y á»• lÆ°u trá»¯.  
  - GiÃºp giáº£m gÃ¡nh náº·ng cho ngÆ°á»i quáº£n trá»‹ CSDL.



- **Collation**: 

| Collation | PhÃ¢n biá»‡t hoa thÆ°á»ng | PhÃ¢n biá»‡t cÃ³ giáº¥u | VÃ­ dá»¥             |
| --------- | -------------------- | ----------------- | ----------------- |
| `CI_AS `| `KhÃ´ng`| `CÃ³`                | `DÅ©NG , DÅ©ng`       |
| `CI_AI`     | `KhÃ´ng`                | `KhÃ´ng`             | `DÅ©ng ,DUng , DÅ¨NG `|
| `CS_AS`     | `CÃ³`                   |` CÃ³ `               | `DÅ©ng ` |
|`CS_AI`    | `CÃ³ `                  | `KhÃ´ng `            | `DÅ©ng ,Dung` |

  - CÃº phÃ¡p:  
    ```sql
    SELECT * FROM sinhvien WHERE ten LIKE 'Du%' COLLATE Latin1_General_CI_AS
    ```
    
## CÃ¡c loáº¡i table Ä‘áº·c biá»‡t

### temporary table báº£ng táº¡m
- LÃ  báº£ng chá»‰ lÆ°u dá»¯ liá»‡u táº¡m thá»i trong quÃ¡ trÃ¬nh xá»­ lÃ½.
- Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trong `tempdb`.
- CÃ¡ch táº¡o:
  - CÃ¡ch 1: 
    ```sql
    CREATE TABLE #NhanVien (
      manv CHAR(4),
      tennv NVARCHAR(100)
    );
    ```
  - CÃ¡ch 2:
    ```sql
    SELECT manv, tennv INTO #nvp1 FROM nhanvien WHERE manv = '001';
    ```

### CTE common table expression
- LÃ  báº£ng táº¡m thá»i trong cÃ¢u truy váº¥n.
- Tá»“n táº¡i trong suá»‘t thá»i gian cá»§a cÃ¢u truy váº¥n.
- GiÃºp tÃ¡ch nhá» cÃ¢u truy váº¥n phá»©c táº¡p, há»— trá»£ Ä‘á»‡ quy.
- CÃº phÃ¡p:
  ```sql
  WITH nameCTE AS (
    body CTE
  )
  SELECT * FROM nameCTE;
  ```
- VÃ­ dá»¥:
  ```sql
  WITH nhanvientenA AS (
    SELECT * FROM nhanvien WHERE ten LIKE 'A%'
  )
  SELECT * FROM nhanvientenA;
  ```

### ðŸ“¦ Memory-Optimized Tables
- Báº£ng lÆ°u trá»¯ trong bá»™ nhá»› RAM Ä‘á»ƒ tÄƒng hiá»‡u suáº¥t.
- Má»™t báº£n sao lÆ°u váº«n Ä‘Æ°á»£c lÆ°u trÃªn á»• cá»©ng Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u.
- VÃ­ dá»¥:
  ```sql
  ALTER DATABASE QLSV ADD FILEGROUP QUANLYSINHVIEN CONTAINS MEMORY_OPTIMIZED_DATA;
  ALTER DATABASE QLSV ADD FILE (
    NAME = 'QUANLYSV',
    FILENAME = 'E:\\QLSV\\QUANLY.MDF'
  ) TO FILEGROUP QUANLYSINHVIEN;

  CREATE TABLE LOPHOC (
    ID INT PRIMARY KEY NONCLUSTERED,
    TENLOP CHAR(10)
  ) WITH (MEMORY_OPTIMIZED = ON);
  ```

### ðŸ“¦ Partitioned Tables
- PhÃ¢n máº£nh dá»¯ liá»‡u ngang, lÆ°u vÃ o nhiá»u filegroup khÃ¡c nhau.
- GiÃºp quáº£n lÃ½ dá»¯ liá»‡u hiá»‡u quáº£ vÃ  Ä‘áº£m báº£o toÃ n váº¹n.
- CÃ¡c bÆ°á»›c:
  ```sql
  ALTER DATABASE QLSV ADD FILEGROUP GR_LOPTH01;
  ALTER DATABASE QLSV ADD FILEGROUP GR_LOPTH02;
  ALTER DATABASE QLSV ADD FILEGROUP GR_LOPTH03;
  ALTER DATABASE QLSV ADD FILEGROUP GR_LOPTH04;

  ALTER DATABASE QLSV ADD FILE (NAME = 'LOPTH01', FILENAME = 'E:\\QLSV\\LOPTH01.ndf') TO FILEGROUP GR_LOPTH01;
  ALTER DATABASE QLSV ADD FILE (NAME = 'LOPTH02', FILENAME = 'E:\\QLSV\\LOPTH02.ndf') TO FILEGROUP GR_LOPTH02;
  ALTER DATABASE QLSV ADD FILE (NAME = 'LOPTH03', FILENAME = 'E:\\QLSV\\LOPTH03.ndf') TO FILEGROUP GR_LOPTH03;
  ALTER DATABASE QLSV ADD FILE (NAME = 'LOPTH04', FILENAME = 'E:\\QLSV\\LOPTH04.ndf') TO FILEGROUP GR_LOPTH04;

  CREATE PARTITION FUNCTION pf_LOPHOC(INT)
  AS RANGE LEFT FOR VALUES (1,2,3);

  CREATE PARTITION SCHEME ps_LOPHOC
  AS PARTITION pf_LOPHOC TO (GR_LOPTH01, GR_LOPTH02, GR_LOPTH03, GR_LOPTH04);

  CREATE TABLE SINHVIEN (
    ID INT IDENTITY NOT NULL,
    TENSV VARCHAR(100) NOT NULL,
    DTB FLOAT NULL,
    MALOP INT NOT NULL
  ) ON ps_LOPHOC(MALOP);

  CREATE CLUSTERED INDEX idxLOPHOC ON SINHVIEN(MALOP)
  ON ps_LOPHOC(MALOP);
  ```

### ðŸ“¦ Temporal Tables
- Báº£ng há»— trá»£ lÆ°u trá»¯ lá»‹ch sá»­ thay Ä‘á»•i tá»± Ä‘á»™ng.
- Cá»© má»—i láº§n thay Ä‘á»•i, dá»¯ liá»‡u cÅ© Ä‘Æ°á»£c lÆ°u láº¡i.
- VÃ­ dá»¥:
  ```sql
  CREATE TABLE NVien (
    MSNV CHAR(4) PRIMARY KEY CLUSTERED,
    HoTen NVARCHAR(20),
    MSPB CHAR(2),
    Luong INT,
    ValidFrom DATETIME2 GENERATED ALWAYS AS ROW START,
    ValidTo DATETIME2 GENERATED ALWAYS AS ROW END,
    PERIOD FOR SYSTEM_TIME (ValidFrom, ValidTo)
  )
  WITH (SYSTEM_VERSIONING = ON (HISTORY_TABLE = dbo.NVienHistory));
  ```

---

### View

- **Standard View**: báº£ng áº£o, khÃ´ng chá»©a dá»¯ liá»‡u thá»±c.
- CÃ´ng dá»¥ng: che giáº¥u sá»± phá»©c táº¡p truy váº¥n, táº¡o truy váº¥n trung gian.

VÃ­ dá»¥:
```sql
CREATE VIEW SINHVIENLOP_1 AS
SELECT * FROM SINHVIEN WHERE MALOP = 1
WITH CHECK OPTION;

SELECT * FROM SINHVIENLOP_1;
```

---

### Index

| Loáº¡i Index | Giáº£i thÃ­ch chi tiáº¿t | VÃ­ dá»¥ |
|:---|:---|:---|
| Dense Index | Cá»© má»—i giÃ¡ trá»‹ khÃ³a Ä‘á»u cÃ³ má»™t record trong index. | Cá»© 1000 dÃ²ng â†’ Dense Index cÅ©ng chá»©a 1000 dÃ²ng. |
| Sparse (Non-Dense) Index | Chá»‰ lÆ°u vÃ i giÃ¡ trá»‹ Ä‘áº¡i diá»‡n, tiáº¿t kiá»‡m bá»™ nhá»›. | LÆ°u Ä‘iá»ƒm má»‘c má»—i 10 dÃ²ng. |
| Primary Index | Táº¡o trÃªn khÃ³a chÃ­nh, báº£n ghi sáº¯p xáº¿p theo khÃ³a chÃ­nh. | Báº£ng SinhVien theo MSV. |
| Clustering Index | Sáº¯p xáº¿p váº­t lÃ½ dá»¯ liá»‡u theo giÃ¡ trá»‹ cÃ³ thá»ƒ trÃ¹ng. | HoÃ¡ Ä‘Æ¡n theo NgÃ yHD. |
| Secondary Index | KhÃ´ng thay Ä‘á»•i váº­t lÃ½ dá»¯ liá»‡u, táº¡o báº£ng tra cá»©u nhanh. | Index phá»¥ trÃªn tÃªn nhÃ¢n viÃªn. |


## HÃ m trong SQL
# ðŸ“Œ Danh sÃ¡ch cÃ¡c hÃ m SQL Server cÆ¡ báº£n

## NhÃ³m hÃ m ngÃ y thÃ¡ng (Date & Time)
| HÃ m | Chá»©c nÄƒng | VÃ­ dá»¥ |
|------|----------|-------|
| `GETDATE()` | Láº¥y ngÃ y giá» hiá»‡n táº¡i | `SELECT GETDATE();` |
| `SYSDATETIME()` | Láº¥y ngÃ y giá» chÃ­nh xÃ¡c hÆ¡n `GETDATE()` | `SELECT SYSDATETIME();` |
| `DATEADD(unit, sá»‘_lÆ°á»£ng, ngÃ y_gá»‘c)` | Cá»™ng/trá»« má»™t khoáº£ng thá»i gian vÃ o ngÃ y | `SELECT DATEADD(DAY, 10, '2024-03-14');` |
| `DATEDIFF(unit, ngÃ y1, ngÃ y2)` | TÃ­nh khoáº£ng cÃ¡ch giá»¯a 2 ngÃ y | `SELECT DATEDIFF(YEAR, '2000-01-01', '2025-03-14');` |
| `DATENAME(unit, ngÃ y)` | Tráº£ vá» tÃªn cá»§a Ä‘Æ¡n vá»‹ thá»i gian | `SELECT DATENAME(WEEKDAY, GETDATE());` |
| `YEAR(ngÃ y)` | Láº¥y nÄƒm cá»§a ngÃ y | `SELECT YEAR(GETDATE());` |
| `MONTH(ngÃ y)` | Láº¥y thÃ¡ng cá»§a ngÃ y | `SELECT MONTH(GETDATE());` |
| `DAY(ngÃ y)` | Láº¥y ngÃ y cá»§a thÃ¡ng | `SELECT DAY(GETDATE());` |

## NhÃ³m hÃ m xá»­ lÃ½ chuá»—i (String Functions)
| HÃ m | Chá»©c nÄƒng | VÃ­ dá»¥ |
|------|----------|-------|
| `LEN(chuá»—i)` | Äá»™ dÃ i chuá»—i (khÃ´ng tÃ­nh khoáº£ng tráº¯ng cuá»‘i) | `SELECT LEN('Hello');` |
| `CHARINDEX('chuá»—i', nguá»“n)` | TÃ¬m vá»‹ trÃ­ chuá»—i con | `SELECT CHARINDEX('SQL', 'Hello SQL Server');` |
| `LEFT(chuá»—i, sá»‘_kÃ½_tá»±)` | Láº¥y N kÃ½ tá»± tá»« trÃ¡i | `SELECT LEFT('Database', 4);` â†’ `Data` |
| `RIGHT(chuá»—i, sá»‘_kÃ½_tá»±)` | Láº¥y N kÃ½ tá»± tá»« pháº£i | `SELECT RIGHT('Database', 4);` â†’ `base` |
| `SUBSTRING(chuá»—i, vá»‹_trÃ­, sá»‘_kÃ½_tá»±)` | Cáº¯t chuá»—i con | `SELECT SUBSTRING('Hello SQL', 7, 3);` â†’ `SQL` |
| `UPPER(chuá»—i)` | Chuyá»ƒn thÃ nh chá»¯ hoa | `SELECT UPPER('sql server');` |
| `LOWER(chuá»—i)` | Chuyá»ƒn thÃ nh chá»¯ thÆ°á»ng | `SELECT LOWER('SQL SERVER');` |
| `REPLACE(chuá»—i, tÃ¬m, thay tháº¿)` | Thay tháº¿ chuá»—i | `SELECT REPLACE('SQL Server 2024', '2024', '2025');` |
| `LTRIM(chuá»—i)` | XÃ³a khoáº£ng tráº¯ng Ä‘áº§u chuá»—i | `SELECT LTRIM('  Hello ');` |
| `RTRIM(chuá»—i)` | XÃ³a khoáº£ng tráº¯ng cuá»‘i chuá»—i | `SELECT RTRIM('Hello  ');` |
| `CONCAT(chuá»—i1, chuá»—i2,...)` | Ná»‘i chuá»—i | `SELECT CONCAT('Hello', ' ', 'SQL');` |

## NhÃ³m hÃ m toÃ¡n há»c (Math Functions)
| HÃ m | Chá»©c nÄƒng | VÃ­ dá»¥ |
|------|----------|-------|
| `ABS(sá»‘)` | GiÃ¡ trá»‹ tuyá»‡t Ä‘á»‘i | `SELECT ABS(-10);` |
| `CEILING(sá»‘)` | LÃ m trÃ²n lÃªn | `SELECT CEILING(4.2);` â†’ `5` |
| `FLOOR(sá»‘)` | LÃ m trÃ²n xuá»‘ng | `SELECT FLOOR(4.9);` â†’ `4` |
| `ROUND(sá»‘, sá»‘_lÃ m_trÃ²n)` | LÃ m trÃ²n sá»‘ | `SELECT ROUND(3.14159, 2);` â†’ `3.14` |
| `POWER(sá»‘, lÅ©y_thá»«a)` | LÅ©y thá»«a | `SELECT POWER(2, 3);` â†’ `8` |
| `SQRT(sá»‘)` | CÄƒn báº­c hai | `SELECT SQRT(25);` â†’ `5` |
| `RAND()` | Sinh sá»‘ ngáº«u nhiÃªn | `SELECT RAND();` |

## NhÃ³m hÃ m tá»•ng há»£p (Aggregate Functions)
| HÃ m | Chá»©c nÄƒng | VÃ­ dá»¥ |
|------|----------|-------|
| `SUM(cá»™t)` | TÃ­nh tá»•ng | `SELECT SUM(Salary) FROM Employees;` |
| `AVG(cá»™t)` | TÃ­nh trung bÃ¬nh | `SELECT AVG(Age) FROM Students;` |
| `MIN(cá»™t)` | Láº¥y giÃ¡ trá»‹ nhá» nháº¥t | `SELECT MIN(Salary) FROM Employees;` |
| `MAX(cá»™t)` | Láº¥y giÃ¡ trá»‹ lá»›n nháº¥t | `SELECT MAX(Salary) FROM Employees;` |
| `COUNT(*)` | Äáº¿m sá»‘ dÃ²ng | `SELECT COUNT(*) FROM Orders;` |

## NhÃ³m hÃ m Ä‘iá»u kiá»‡n (Conditional Functions)
| HÃ m | Chá»©c nÄƒng | VÃ­ dá»¥ |
|------|----------|-------|
| `CASE WHEN ... THEN ... ELSE ... END` | Äiá»u kiá»‡n IF-ELSE trong SQL | ```SELECT Name, CASE WHEN Age >= 18 THEN 'Adult' ELSE 'Minor' END FROM Students;``` |
| `COALESCE(a, b, c,...)` | Tráº£ vá» giÃ¡ trá»‹ Ä‘áº§u tiÃªn khÃ¡c NULL | `SELECT COALESCE(NULL, NULL, 'Hello');` |
| `ISNULL(cá»™t, giÃ¡_trá»‹_má»›i)` | Thay tháº¿ giÃ¡ trá»‹ NULL | `SELECT ISNULL(NULL, 'No Data');` |



### VÃ­ dá»¥ táº¡o báº£ng vÃ  rÃ ng buá»™c

```sql
-- Táº¡o báº£ng SinhVien vá»›i khÃ³a chÃ­nh
CREATE TABLE SinhVien(
    MaSV INT PRIMARY KEY NOT NULL,
    HoTen NVARCHAR(100),
    NgaySinh DATETIME
);

-- ThÃªm khÃ³a chÃ­nh vÃ o báº£ng Ä‘Ã£ táº¡o
ALTER TABLE SinhVien ADD CONSTRAINT PK_SinhVien PRIMARY KEY (MaSV);

-- Táº¡o khÃ³a ngoáº¡i liÃªn káº¿t vá»›i báº£ng LopHoc
CREATE TABLE LopHoc(
    MaLop CHAR(10) NOT NULL PRIMARY KEY,
    TenLop NVARCHAR(50)
);

CREATE TABLE SinhVien(
    MaSV INT PRIMARY KEY NOT NULL,
    HoTen NVARCHAR(100),
    NgaySinh DATETIME,
    MaLop CHAR(10) FOREIGN KEY REFERENCES LopHoc(MaLop)
);

-- ThÃªm khÃ³a ngoáº¡i sau khi báº£ng Ä‘Ã£ Ä‘Æ°á»£c táº¡o
ALTER TABLE SinhVien ADD CONSTRAINT FK_SinhVien_LopHoc FOREIGN KEY (MaLop) REFERENCES LopHoc(MaLop);

-- XÃ³a rÃ ng buá»™c khÃ³a ngoáº¡i
ALTER TABLE SinhVien DROP CONSTRAINT FK_SinhVien_LopHoc;

-- Táº¡o rÃ ng buá»™c UNIQUE
CREATE TABLE NhanVien(
    MaNV INT PRIMARY KEY NOT NULL,
    Email NVARCHAR(100) UNIQUE
);

-- ThÃªm rÃ ng buá»™c UNIQUE vÃ o báº£ng Ä‘Ã£ tá»“n táº¡i
ALTER TABLE NhanVien ADD CONSTRAINT UQ_NhanVien_Email UNIQUE (Email);

-- XÃ³a rÃ ng buá»™c UNIQUE
ALTER TABLE NhanVien DROP CONSTRAINT UQ_NhanVien_Email;
-- ThÃªm NOT NULL vÃ o cá»™t Ä‘Ã£ tá»“n táº¡i
ALTER TABLE NhanVien 
ALTER COLUMN MaNV INT NOT NULL;

-- ThÃªm NULL cho cá»™t ALTER TABLE MonHoc 
ALTER TABLE NhanVien
ALTER COLUMN MaNV INT NULL;

-- RÃ ng buá»™c CHECK kiá»ƒm tra Ä‘iá»u kiá»‡n 
CREATE TABLE SinhVien (
    MaSV INT PRIMARY KEY,
    HoTen NVARCHAR(100),
    Diem FLOAT CHECK (Diem >= 0 AND Diem <= 10) -- Äiá»ƒm chá»‰ tá»« 0 Ä‘áº¿n 10
);

-- RÃ ng buá»™c DEFAULT giÃ¡ trá»‹ máº·c Ä‘á»‹nh 
CREATE TABLE NhanVien (
    MaNV INT PRIMARY KEY,
    HoTen NVARCHAR(100),
    TrangThai BIT DEFAULT 1 -- Máº·c Ä‘á»‹nh lÃ  "Ä‘ang lÃ m viá»‡c" (1)
);
-- ThÃªm rÃ ng buá»™c khi Ä‘Ã£ táº¡o báº£ng 
ALTER TABLE NhanVien 
ADD CONSTRAINT DF_NhanVien_TrangThai DEFAULT 1 FOR TrangThai;

-- ThÃªm rÃ ng buá»™c CHECK khi Ä‘Ã£ táº¡o báº£ng 
ALTER TABLE SinhVien 
ADD CONSTRAINT CK_SinhVien_Diem CHECK (Diem >= 0 AND Diem <= 10);


```

## Kiá»ƒm tra thÃ´ng tin database
```sql
EXEC sp_helpdb 'Testdb';
```


